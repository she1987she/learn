<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¨ˆç®—æ©Ÿè€ƒé¡Œæ¸¬é©—ï¼ˆæ¸¬è©¦ç‰ˆï¼‰ï½œMario ä¸»é¡ŒéŠæˆ²</title>
  <link rel="stylesheet" href="index.css">
</head>
<body class="mario-bg">
  <header class="mario-header">
    <button class="mario-btn mario-back" onclick="location.href='index.html'">è¿”å›éŠæˆ²é¦–é </button>
    <h1 class="mario-title">è¨ˆç®—æ©Ÿè€ƒé¡Œæ¸¬é©—ï¼ˆæ¸¬è©¦ç‰ˆï¼‰</h1>
  </header>
  <main class="mario-main">
    <section class="mario-game-area mario-quiz-area">
      <div style="margin-bottom:1.5rem;text-align:center;">
        <button class="mario-btn" onclick="startQuiz('easy')" style="margin:0 0.5rem;">ç°¡å–®æ¨¡å¼</button>
        <button class="mario-btn" onclick="startQuiz('normal')" style="margin:0 0.5rem;">æ™®é€šæ¨¡å¼</button>
        <button class="mario-btn" onclick="startQuiz('hard')" style="margin:0 0.5rem;">å›°é›£æ¨¡å¼</button>
      </div>
      <div id="quiz-container">
        <div class="mario-quiz-block">
          <h3>è«‹é¸æ“‡é›£åº¦é–‹å§‹éŠæˆ²</h3>
          <p>é¸æ“‡ä¸Šæ–¹çš„é›£åº¦æŒ‰éˆ•å³å¯é–‹å§‹è¨ˆç®—æ©Ÿè€ƒé¡Œæ¸¬é©—ï¼</p>
        </div>
      </div>
      <div id="quiz-result" style="display:none;text-align:center;">
        <h2 class="mario-title">ğŸ‰ æ­å–œå®Œæˆï¼</h2>
        <div class="mario-quiz-status" style="font-size:1.5em;">
          <span class="mario-quiz-score">ç¸½åˆ†ï¼š<span id="final-score">0</span> <span class="mario-coin">ğŸª™</span></span>
        </div>
        <div id="clear-time-area" class="mario-quiz-status"></div>
        <button class="mario-btn" onclick="location.reload()">å†ç©ä¸€æ¬¡</button>
      </div>
    </section>
    <section class="mario-leaderboard" id="leaderboard-section">
      <h2 class="mario-subtitle">æ’è¡Œæ¦œ</h2>
      <ul id="leaderboard-list">
        <!-- æ’è¡Œæ¦œå…§å®¹ç”± JS ç”¢ç”Ÿ -->
      </ul>
    </section>
  </main>

<script>
// ç°¡åŒ–ç‰ˆæœ¬çš„è¨ˆç®—æ©Ÿè€ƒé¡Œæ¸¬é©—
let currentQuizIndex = 0;
let quizScore = 0;
let quizStartTime = null;
let quizData = [];

// ç”Ÿæˆé¡Œç›®
function generateQuiz(difficulty = 'normal') {
  const questions = [];
  const count = 5; // ç°¡åŒ–ç‚º5é¡Œ
  
  let maxNum = 10;
  if (difficulty === 'easy') maxNum = 10;
  else if (difficulty === 'normal') maxNum = 20;
  else if (difficulty === 'hard') maxNum = 50;
  
  for (let i = 0; i < count; i++) {
    const operations = ['+', '-', 'Ã—', 'Ã·'];
    const op = operations[Math.floor(Math.random() * operations.length)];
    
    let a = Math.floor(Math.random() * maxNum) + 1;
    let b = Math.floor(Math.random() * maxNum) + 1;
    
    // ç¢ºä¿é™¤æ³•èƒ½æ•´é™¤
    if (op === 'Ã·') {
      a = a * b;
    }
    
    // ç¢ºä¿æ¸›æ³•ä¸ç‚ºè² æ•¸
    if (op === '-' && a < b) {
      [a, b] = [b, a];
    }
    
    let answer;
    switch (op) {
      case '+': answer = a + b; break;
      case '-': answer = a - b; break;
      case 'Ã—': answer = a * b; break;
      case 'Ã·': answer = a / b; break;
    }
    
    // ç”Ÿæˆé¸é …
    const options = [answer];
    while (options.length < 4) {
      const fake = answer + Math.floor(Math.random() * 10) - 5;
      if (fake > 0 && !options.includes(fake)) {
        options.push(fake);
      }
    }
    
    // æ´—ç‰Œ
    options.sort(() => Math.random() - 0.5);
    
    questions.push({
      question: `${a} ${op} ${b} = ?`,
      options: options,
      correct: options.indexOf(answer)
    });
  }
  
  return questions;
}

// é–‹å§‹æ¸¬é©—
function startQuiz(difficulty) {
  console.log('é–‹å§‹', difficulty, 'é›£åº¦æ¸¬é©—');
  
  quizData = generateQuiz(difficulty);
  currentQuizIndex = 0;
  quizScore = 0;
  quizStartTime = Date.now();
  
  document.getElementById('quiz-result').style.display = 'none';
  showQuestion();
}

// é¡¯ç¤ºå•é¡Œ
function showQuestion() {
  if (currentQuizIndex >= quizData.length) {
    showResult();
    return;
  }
  
  const question = quizData[currentQuizIndex];
  const container = document.getElementById('quiz-container');
  
  container.innerHTML = `
    <div class="mario-quiz-block">
      <div class="mario-quiz-question">
        <span class="mario-quiz-qnum">ç¬¬ ${currentQuizIndex + 1} é¡Œ</span>
        <span class="mario-quiz-qtext">${question.question}</span>
      </div>
      <div class="mario-quiz-options">
        ${question.options.map((opt, i) => 
          `<button class="mario-btn mario-option" onclick="selectAnswer(${i})">${opt}</button>`
        ).join('')}
      </div>
      <div class="mario-quiz-status">
        <span class="mario-quiz-score">åˆ†æ•¸ï¼š${quizScore} <span class="mario-coin">ğŸª™</span></span>
      </div>
    </div>
  `;
}

// é¸æ“‡ç­”æ¡ˆ
function selectAnswer(selectedIndex) {
  const question = quizData[currentQuizIndex];
  const buttons = document.querySelectorAll('.mario-option');
  
  // ç¦ç”¨æ‰€æœ‰æŒ‰éˆ•
  buttons.forEach(btn => btn.disabled = true);
  
  if (selectedIndex === question.correct) {
    buttons[selectedIndex].style.backgroundColor = '#4CAF50';
    quizScore += 20;
    console.log('ç­”å°äº†ï¼');
  } else {
    buttons[selectedIndex].style.backgroundColor = '#f44336';
    buttons[question.correct].style.backgroundColor = '#4CAF50';
    console.log('ç­”éŒ¯äº†ï¼');
  }
  
  // æ›´æ–°åˆ†æ•¸é¡¯ç¤º
  document.querySelector('.mario-quiz-score').innerHTML = `åˆ†æ•¸ï¼š${quizScore} <span class="mario-coin">ğŸª™</span>`;
  
  // 1ç§’å¾Œé¡¯ç¤ºä¸‹ä¸€é¡Œ
  setTimeout(() => {
    currentQuizIndex++;
    showQuestion();
  }, 1500);
}

// é¡¯ç¤ºçµæœ
function showResult() {
  const endTime = Date.now();
  const duration = Math.round((endTime - quizStartTime) / 1000);
  
  document.getElementById('quiz-container').style.display = 'none';
  document.getElementById('final-score').textContent = quizScore;
  document.getElementById('clear-time-area').innerHTML = `é€šé—œæ™‚é–“ï¼š${duration} ç§’ <span class="mario-coin">â±ï¸</span>`;
  document.getElementById('quiz-result').style.display = 'block';
  
  console.log('æ¸¬é©—å®Œæˆï¼åˆ†æ•¸ï¼š', quizScore, 'æ™‚é–“ï¼š', duration, 'ç§’');
}

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
  console.log('æ¸¬è©¦ç‰ˆè¨ˆç®—æ©Ÿè€ƒé¡Œæ¸¬é©—è¼‰å…¥å®Œæˆ');
});
</script>
</body>
</html>
